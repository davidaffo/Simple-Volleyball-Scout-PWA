<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Simple Volleyball Scout PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#111111" />
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
</head>
<body>
  <div id="update-banner" class="update-banner hidden" role="status" aria-live="polite">
    <span class="update-banner-text">Aggiornamento disponibile.</span>
    <div class="update-banner-actions">
      <button id="update-banner-refresh" class="small">Aggiorna</button>
      <button id="update-banner-dismiss" class="small secondary">Chiudi</button>
    </div>
  </div>
  <div class="tabs-nav centered">
    <h1 class="app-title">Simple Volleyball Scout PWA</h1>
    <a class="manual-link-btn hidden" href="manual.html">Manuale</a>
    <button class="tab-btn active" data-tab-target="info">Impostazioni partita</button>
    <button class="tab-btn" data-tab-target="scout">Scout live</button>
    <button class="tab-btn" data-tab-target="aggregated">Analisi</button>
    <button class="tab-btn" data-tab-target="video">Video</button>
  </div>
  <div class="tabs-dots" aria-label="Navigazione pagine">
    <button class="tab-btn tab-dot" data-tab-target="info" aria-label="Impostazioni partita"></button>
    <button class="tab-btn tab-dot" data-tab-target="scout" aria-label="Scout live"></button>
    <button class="tab-btn tab-dot" data-tab-target="aggregated" aria-label="Analisi"></button>
    <button class="tab-btn tab-dot" data-tab-target="video" aria-label="Video"></button>
    <span class="tab-swipe-hint" aria-hidden="true">swipe ‚Üî</span>
  </div>
  <div class="tab-panel active" data-tab="info">
    <div class="section">
      <h2>Impostazioni partita</h2>
      <div class="top-bar match-info-bar">
        <div class="col">
          <label>Match corrente</label>
          <div id="match-summary" class="match-summary">‚Äî</div>
        </div>
        <div class="col col-auto">
          <label class="spacer-label">&nbsp;</label>
          <button id="btn-open-match-manager" class="secondary" type="button" onclick="window.openMatchManagerModal && window.openMatchManagerModal()">Gestione match</button>
        </div>
        <div class="col col-auto">
          <label>Tema</label>
          <div class="theme-toggle">
            <button type="button" id="theme-dark" class="secondary" aria-pressed="false" title="Tema scuro">üåô</button>
            <button type="button" id="theme-light" class="secondary" aria-pressed="false" title="Tema chiaro">‚òÄÔ∏è</button>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <h2>Squadra</h2>
      <p class="section-note">Seleziona le squadre dal database. Gestione, importazione ed esportazione passano da ‚ÄúGestione squadre‚Äù.</p>
      <div class="team-manage">
        <label class="auto-rotate-toggle">
          <input type="checkbox" id="use-opponent-team-toggle" />
          Usa squadra avversaria
        </label>
        <div class="team-manage-grid">
          <div class="team-manage-col">
            <h4>Squadra nostra</h4>
            <select id="saved-teams"></select>
            <p id="teams-empty-hint" class="section-note hidden">
              Nessuna squadra salvata. Crea una nuova squadra da ‚ÄúGestione squadre‚Äù.
            </p>
            <button id="btn-open-team-manager" class="secondary">Gestione squadra</button>
          </div>
          <div class="team-manage-col opponent-settings hidden" id="opponent-team-settings">
            <h4>Squadra avversaria</h4>
            <select id="saved-opponent-teams"></select>
            <div class="opponent-skill-toggles">
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-serve" />
                Battuta
              </label>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-pass" />
                Ricezione
              </label>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-attack" />
                Attacco
              </label>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-defense" />
                Difesa
              </label>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-block" />
                Muro
              </label>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="opponent-skill-second" />
                Alzata
              </label>
            </div>
            <button id="btn-open-opponent-team-manager" class="secondary">Gestione squadra</button>
          </div>
        </div>
        <div class="team-manage-actions">
          <button id="btn-open-teams-manager" class="secondary">Gestione squadre</button>
        </div>
      </div>
    </div>
    <div class="section">
      <details class="import-panel metrics-panel" open>
        <summary>Regole calcolo efficienza/positivit√†</summary>
        <p class="section-note">Positivit√† = positivi / totali ¬∑ Efficienza = (positivi - negativi) / totali ¬∑ Perfezione = # / totali.<br>Nota bene: √® sconsigliato togliere codici, disattivare battuta, ricezione attacco e modificare le regole di assegnazione punto quando si utilizza la modalit√† automatica. </p>
        <div class="controls-row metrics-actions">
          <button id="btn-reset-codes" class="secondary">Riattiva tutte le valutazioni</button>
          <button id="btn-reset-metrics" class="secondary">Ripristina criteri calcolo efficienza</button>
          <button id="btn-reset-points" class="secondary">Ripristina punti default</button>
        </div>
        <div id="metrics-config" class="metrics-config"></div>
      </details>
    </div>
    
  </div>

  <div class="tab-panel" data-tab="scout">
    <div class="scout-mobile-bar">
      <button id="btn-open-menu-mobile" class="secondary small" type="button" aria-label="Impostazioni">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 8.75a3.25 3.25 0 1 0 0 6.5a3.25 3.25 0 0 0 0-6.5ZM4.7 9.9l-1.65-1a1 1 0 0 1-.36-1.37l1.4-2.42a1 1 0 0 1 1.34-.4l1.8.78a7.7 7.7 0 0 1 1.64-.95l.28-1.94A1 1 0 0 1 9.15 1h2.7a1 1 0 0 1 .99.86l.28 1.94c.58.23 1.12.54 1.64.95l1.8-.78a1 1 0 0 1 1.34.4l1.4 2.42a1 1 0 0 1-.36 1.37l-1.65 1c.08.52.12 1.05.12 1.6s-.04 1.08-.12 1.6l1.65 1a1 1 0 0 1 .36 1.37l-1.4 2.42a1 1 0 0 1-1.34.4l-1.8-.78a7.7 7.7 0 0 1-1.64.95l-.28 1.94a1 1 0 0 1-.99.86h-2.7a1 1 0 0 1-.99-.86l-.28-1.94a7.7 7.7 0 0 1-1.64-.95l-1.8.78a1 1 0 0 1-1.34-.4l-1.4-2.42a1 1 0 0 1 .36-1.37l1.65-1a9.9 9.9 0 0 1-.12-1.6c0-.55.04-1.08.12-1.6Z"/>
        </svg>
      </button>
      <button id="btn-open-log-mobile" class="secondary small" type="button">Log</button>
    </div>
    <div id="scout-drawer-backdrop" class="drawer-backdrop" aria-hidden="true"></div>
    <div class="scout-grid">
      <div class="section scout-col-left" data-scout-panel="match">
        <button class="drawer-close secondary small" type="button" data-close-drawer="menu">Chiudi</button>
        <div class="set-controls grid-row">
          <div class="score-card score-card-top">
            <div class="score-top-row">
              <div class="score-set-select">
                <label for="current-set">Set corrente</label>
                <div class="set-display" id="current-set-display" aria-live="polite">Set 1</div>
                <select id="current-set" class="hidden-select" tabindex="-1" aria-hidden="true">
                  <option value="1">Set 1</option>
                  <option value="2">Set 2</option>
                  <option value="3">Set 3</option>
                  <option value="4">Set 4</option>
                  <option value="5">Set 5</option>
                </select>
              </div>
            </div>
          <div class="score-layout">
            <div class="score-side score-side-for">
              <button id="btn-score-for-plus" class="small">+ Fatti</button>
              <button id="btn-score-for-minus" class="small secondary">- Fatti</button>
            </div>
              <div class="score-center">
                <label>Punteggio</label>
                <div id="live-score" class="score-value emph">0 - 0</div>
                <div class="score-set-row">
                  <span class="score-set-label">Set</span>
                  <strong id="live-set-score" class="score-set-value">0 - 0</strong>
                </div>
              </div>
              <div class="score-side score-side-against">
                <button id="btn-score-against-plus" class="small">+ Subiti</button>
                <button id="btn-score-against-minus" class="small secondary">- Subiti</button>
              </div>
            </div>
          </div>
          <div class="set-bottom-actions">
            <button id="btn-next-set" class="small secondary">Set successivo</button>
            <button id="btn-end-match" class="small danger">Pausa/Termina</button>
          </div>
          <div class="rotation-toggles">
            <label class="auto-rotate-toggle">
              <input type="checkbox" id="auto-rotate-toggle" />
              Rotazione automatica su cambio palla
            </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="auto-role-toggle" />
                Auto posizionamento per ruolo
              </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="predictive-skill-toggle" />
                Flusso di gioco automatico
                </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="attack-trajectory-simple-toggle" />
                Direzione attacco semplificata
              </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="force-mobile-toggle" />
                Modalit√† mobile (test)
              </label>
          <label class="auto-rotate-toggle">
                <input type="checkbox" id="video-scout-toggle" />
                Scout da video
              </label>
            </div>
            <div class="set-bottom-actions">
              <button id="btn-toggle-court-view" class="small secondary" type="button">Cambia campo</button>
            </div>
            <div class="court-actions-bar team-panel team-panel--home" data-team-panel="home-settings">
              <h3 class="panel-title">Impostazioni squadra</h3>
              <div class="rotation-toggles">
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="auto-role-p1american-toggle" />
                  P1 americana
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="attack-trajectory-toggle" />
                  Traiettoria attacco
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="settype-prompt-toggle-inline" />
                  Tipo alzata
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="serve-trajectory-toggle-inline" />
                  Traiettoria servizio
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="serve-trajectory-log-toggle-inline" />
                  Traiettorie del battitore
                </label>
              </div>
              <div class="team-timeout-block">
                <button id="btn-timeout" class="small secondary">Timeout</button>
                <button id="btn-open-lineup" class="secondary small">Formazione/Sostituzione</button>
                <span class="team-counter">TO: <strong id="timeout-count">0</strong></span>
                <span class="team-counter">Cambi: <strong id="substitution-remaining">6</strong></span>
              </div>
            </div>
            <div class="court-actions-bar team-panel team-panel--opponent" data-team-panel="opponent-settings">
              <h3 class="panel-title">Impostazioni avversaria</h3>
              <div class="rotation-toggles">
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="auto-role-p1american-toggle-opp" />
                  P1 americana
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="attack-trajectory-toggle-opp" />
                  Traiettoria attacco
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="settype-prompt-toggle-inline-opp" />
                  Tipo alzata
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="serve-trajectory-toggle-inline-opp" />
                  Traiettoria servizio
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="serve-trajectory-log-toggle-inline-opp" />
                  Traiettorie del battitore
                </label>
              </div>
              <div class="team-timeout-block">
                <button id="btn-timeout-opp" class="secondary small">Timeout</button>
                <button id="btn-open-lineup-opp" class="secondary small">Formazione/Sostituzione</button>
                <span class="team-counter">TO: <strong id="timeout-opp-count">0</strong></span>
                <span class="team-counter">Cambi: <strong id="substitution-remaining-opp">6</strong></span>
              </div>
            </div>
        </div>
      </div>
      <div class="section scout-col-center" data-scout-panel="team">
        <div class="set-type-wrapper">
          <div class="set-type-shortcuts set-type-inline" id="set-type-shortcuts" style="display: none">
            <div class="set-type-shortcuts__head">
              <span class="set-type-shortcuts__label">Tipo alzata</span>
            </div>
            <div class="set-type-shortcuts__buttons">
              <button class="set-type-btn" data-settype="mezza" type="button">Mezza</button>
              <button class="set-type-btn" data-settype="super" type="button">Super</button>
              <button class="set-type-btn" data-settype="quick" type="button">Quick</button>
              <button class="set-type-btn" data-settype="veloce" type="button">Veloce</button>
              <button class="set-type-btn" data-settype="fast" type="button">Fast</button>
              <button class="set-type-btn" data-settype="alta" type="button">Alta</button>
              <button class="set-type-btn secondary" data-clear-settype type="button">Nessuna</button>
            </div>
          </div>
        </div>
        <div id="video-scout-container" class="video-scout-container hidden">
          <div class="video-scout-panel">
            <div class="video-scout-actions">
              <label class="file-btn" for="video-file-input-scout">Carica video</label>
              <input id="video-file-input-scout" type="file" accept="video/*" hidden />
              <div class="youtube-input">
                <input id="youtube-url-input-scout" type="url" placeholder="https://youtu.be/..." />
                <button id="btn-load-youtube-scout" class="secondary">Usa YouTube</button>
              </div>
            </div>
            <div class="video-player-wrap video-player-wrap--scout">
              <div class="video-media">
                <video id="analysis-video-scout" controls preload="metadata"></video>
                <iframe
                  id="youtube-frame-scout"
                  class="youtube-frame"
                  title="YouTube player"
                  tabindex="-1"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen
                ></iframe>
                <div class="youtube-focus-guard" data-youtube-guard></div>
              </div>
            </div>
          </div>
        </div>
        <div class="players-area" id="court-area">
          <div class="team-panel team-panel--far team-panel--opponent" data-team-panel="opponent">
            <div class="team-field-box team-field-box--opponent">
              <div class="court-actions-bar court-actions-inline team-panel__bar team-panel__bar--opponent">
                <div class="rotation-block court-rotation-block">
                <div class="rotation-controls">
                  <button id="btn-rotate-cw-opp" class="small rotate-cw">‚Ü∫</button>
                  <div class="rotation-display">
                    <select id="rotation-select-opp" class="rotation-select">
                      <option value="1">P1</option>
                      <option value="2">P2</option>
                      <option value="3">P3</option>
                      <option value="4">P4</option>
                      <option value="5">P5</option>
                      <option value="6">P6</option>
                    </select>
                  </div>
                  <button id="btn-rotate-ccw-opp" class="small rotate-ccw">‚Üª</button>
                </div>
                </div>
                <div class="score-actions court-game-actions">
                  <button id="btn-score-opp-point" class="small success">Punto</button>
                  <button id="btn-score-opp-error" class="small danger">Errore</button>
                  <button id="btn-freeball-opp" class="secondary small">Freeball</button>
                </div>
                <div class="team-controls-panel">
                  <div class="libero-inline">
                    <label>Libero</label>
                    <div id="libero-tags-inline-opp" class="libero-tags"></div>
                    <label class="auto-libero-inline">
                      <span>Auto L</span>
                      <select id="auto-libero-select-opp">
                        <option value="">Nessuno</option>
                        <option value="P">P</option>
                        <option value="S">S</option>
                        <option value="C">C</option>
                        <option value="O">O</option>
                      </select>
                    </label>
                    <button type="button" id="btn-swap-libero-opp" class="small secondary">Cambia L</button>
                  </div>
                  <div class="skill-flow-panel">
                    <label>Forza prossima skill</label>
                    <div class="skill-flow-grid skill-flow-inline" id="skill-flow-buttons-opp">
                      <button type="button" class="skill-flow-btn badge badge-serve" data-force-skill="serve">Ba</button>
                      <button type="button" class="skill-flow-btn badge badge-pass" data-force-skill="pass">Ri</button>
                      <button type="button" class="skill-flow-btn badge badge-attack" data-force-skill="attack">At</button>
                      <button type="button" class="skill-flow-btn badge badge-block" data-force-skill="block">Mu</button>
                      <button type="button" class="skill-flow-btn badge badge-defense" data-force-skill="defense">Di</button>
                      <button type="button" class="skill-flow-btn badge badge-second" data-force-skill="second">Al</button>
                    </div>
                  </div>
                </div>
              </div>
              <div id="opponent-players-container"></div>
            </div>
          </div>
          <div class="court-net-divider">
            <span>Rete</span>
            <button id="btn-attack-base" class="small secondary net-action-btn" type="button">Base (K)</button>
            <button id="btn-attack-type" class="small secondary net-action-btn" type="button">Tipo attacco (T)</button>
            <button id="btn-block-number" class="small secondary net-action-btn" type="button">N¬∞ muro (M)</button>
          </div>
          <div class="team-panel team-panel--near team-panel--home" data-team-panel="home">
            <div class="team-field-box team-field-box--home">
              <div id="players-container"></div>
              <div class="court-actions-bar court-actions-inline team-panel__bar team-panel__bar--home">
                <div class="rotation-block court-rotation-block">
                <div class="rotation-controls">
                  <button id="btn-rotate-cw" class="small rotate-cw">‚Ü∫</button>
                  <div class="rotation-display">
                    <select id="rotation-select" class="rotation-select">
                      <option value="1">P1</option>
                      <option value="2">P2</option>
                      <option value="3">P3</option>
                      <option value="4">P4</option>
                      <option value="5">P5</option>
                      <option value="6">P6</option>
                    </select>
                  </div>
                  <button id="btn-rotate-ccw" class="small rotate-ccw">‚Üª</button>
                </div>
                </div>
                <div class="score-actions court-game-actions">
                  <button id="btn-score-team-point" class="small">Punto</button>
                  <button id="btn-score-team-error" class="small danger">Errore</button>
                  <button id="btn-freeball" class="secondary small">Freeball</button>
                </div>
                <div class="team-controls-panel">
                  <div class="libero-inline">
                    <label>Libero</label>
                    <div id="libero-tags-inline" class="libero-tags"></div>
                    <label class="auto-libero-inline">
                      <span>Auto L</span>
                      <select id="auto-libero-select">
                        <option value="">Nessuno</option>
                        <option value="P">P</option>
                        <option value="S">S</option>
                        <option value="C">C</option>
                        <option value="O">O</option>
                      </select>
                    </label>
                    <button type="button" id="btn-swap-libero" class="small secondary">Cambia L</button>
                  </div>
                  <div class="skill-flow-panel">
                    <label>Forza prossima skill</label>
                    <div class="skill-flow-grid skill-flow-inline" id="skill-flow-buttons">
                      <button type="button" class="skill-flow-btn badge badge-serve" data-force-skill="serve">Ba</button>
                      <button type="button" class="skill-flow-btn badge badge-pass" data-force-skill="pass">Ri</button>
                      <button type="button" class="skill-flow-btn badge badge-attack" data-force-skill="attack">At</button>
                      <button type="button" class="skill-flow-btn badge badge-block" data-force-skill="block">Mu</button>
                      <button type="button" class="skill-flow-btn badge badge-defense" data-force-skill="defense">Di</button>
                      <button type="button" class="skill-flow-btn badge badge-second" data-force-skill="second">Al</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="next-set-inline" class="next-set-inline hidden" aria-hidden="true">
            <div class="next-set-inline__card">
              <div class="next-set-inline__head">
                <h3 id="next-set-title">Preparazione set</h3>
                <button id="next-set-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
              </div>
              <div class="next-set__body">
                <div class="next-set-lineups" id="next-set-lineups">
                  <div class="next-set-lineup-block" id="next-set-block-opp">
                    <div class="next-set-lineup-head">
                      <h4 id="next-set-team-opp">Avversarie</h4>
                      <div class="rotation-controls next-set-rotation-controls">
                        <button id="next-set-rotate-cw-opp" class="small rotate-cw" type="button">‚Ü∫</button>
                        <div class="rotation-display">
                          <select id="next-set-rotation-select-opp" class="rotation-select">
                            <option value="1">P1</option>
                            <option value="2">P2</option>
                            <option value="3">P3</option>
                            <option value="4">P4</option>
                            <option value="5">P5</option>
                            <option value="6">P6</option>
                          </select>
                        </div>
                        <button id="next-set-rotate-ccw-opp" class="small rotate-ccw" type="button">‚Üª</button>
                      </div>
                      <button id="next-set-default-opp" class="secondary small" type="button">Imposta default</button>
                    </div>
                    <div id="next-set-court-opp" class="lineup-court-grid next-set-court-grid"></div>
                    <div class="next-set-bench">
                      <div id="next-set-bench-opp" class="lineup-bench-chips"></div>
                    </div>
                  </div>
                  <div class="next-set-lineup-block" id="next-set-block-our">
                    <div class="next-set-lineup-head">
                      <h4 id="next-set-team-our">Squadra nostra</h4>
                      <div class="rotation-controls next-set-rotation-controls">
                        <button id="next-set-rotate-cw-our" class="small rotate-cw" type="button">‚Ü∫</button>
                        <div class="rotation-display">
                          <select id="next-set-rotation-select-our" class="rotation-select">
                            <option value="1">P1</option>
                            <option value="2">P2</option>
                            <option value="3">P3</option>
                            <option value="4">P4</option>
                            <option value="5">P5</option>
                            <option value="6">P6</option>
                          </select>
                        </div>
                        <button id="next-set-rotate-ccw-our" class="small rotate-ccw" type="button">‚Üª</button>
                      </div>
                      <button id="next-set-default-our" class="secondary small" type="button">Imposta default</button>
                    </div>
                    <div id="next-set-court-our" class="lineup-court-grid next-set-court-grid"></div>
                    <div class="next-set-bench">
                      <div id="next-set-bench-our" class="lineup-bench-chips"></div>
                    </div>
                  </div>
                </div>
                <label class="auto-rotate-toggle" id="next-set-swap-row">
                  <input type="checkbox" id="next-set-swap-court" />
                  Cambia campo
                </label>
                <div class="next-set-sides hidden" id="next-set-sides">
                  <div class="next-set__serve-label">Campo vicino</div>
                  <label class="auto-rotate-toggle">
                    <input type="radio" name="next-set-side" id="next-set-side-our" value="our" />
                    <span id="next-set-side-our-label">Noi</span>
                  </label>
                  <label class="auto-rotate-toggle">
                    <input type="radio" name="next-set-side" id="next-set-side-opp" value="opponent" />
                    <span id="next-set-side-opp-label">Avversarie</span>
                  </label>
                </div>
                <div class="next-set__serve">
                  <div class="next-set__serve-label">Prima battuta</div>
                  <label class="auto-rotate-toggle">
                    <input type="radio" name="next-set-serve" id="next-set-serve-our" value="our" />
                    <span id="next-set-serve-our-label">Noi</span>
                  </label>
                  <label class="auto-rotate-toggle">
                    <input type="radio" name="next-set-serve" id="next-set-serve-opp" value="opponent" />
                    <span id="next-set-serve-opp-label">Avversarie</span>
                  </label>
                </div>
                <div class="settings-actions">
                  <button id="next-set-start" class="primary">Avvia set</button>
                  <button id="next-set-cancel" class="secondary">Annulla</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="section log-section scout-col-right" data-log-section data-scout-panel="log">
        <button class="drawer-close secondary small" type="button" data-close-drawer="log">Chiudi</button>
        <div id="log-serve-trajectory" class="log-serve-trajectory">
          <div class="log-serve-trajectory__grid">
            <div class="trajectory-card serve-trajectory-card log-serve-card" id="log-serve-card-our" data-scope="our">
              <div class="log-serve-card__grid">
                <div class="log-serve-card__traj">
                  <div class="trajectory-card__title">Battuta ¬∑ <span id="log-serve-name-our">‚Äî</span></div>
                  <canvas id="log-serve-canvas-our"></canvas>
                  <div class="trajectory-card__empty">Nessuna traiettoria</div>
                </div>
                <div class="log-serve-card__stats">
                  <div class="log-serve-card__stats-title">Dati battuta</div>
                  <div class="log-serve-card__stats-grid" id="log-serve-stats-our"></div>
                </div>
              </div>
            </div>
            <div class="trajectory-card serve-trajectory-card log-serve-card" id="log-serve-card-opp" data-scope="opponent">
              <div class="log-serve-card__grid">
                <div class="log-serve-card__traj">
                  <div class="trajectory-card__title">Battuta ¬∑ <span id="log-serve-name-opp">‚Äî</span></div>
                  <canvas id="log-serve-canvas-opp"></canvas>
                  <div class="trajectory-card__empty">Nessuna traiettoria</div>
                </div>
                <div class="log-serve-card__stats">
                  <div class="log-serve-card__stats-title">Dati battuta</div>
                  <div class="log-serve-card__stats-grid" id="log-serve-stats-opp"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="events-log-summary" class="events-log-summary" aria-live="polite"></div>
        <div id="events-log"></div>
        <div class="card-inline log-undo">
          <button id="btn-undo" class="small danger undo-inline">‚Ü© Annulla ultimo</button>
          <div class="undo-last-summary" aria-live="polite">
            <span>Ultimo codice:</span>
            <strong id="undo-last-summary">‚Äî</strong>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-panel" data-tab="aggregated" id="aggregated-panel">
    <div id="print-match-title" class="print-match-title"></div>
    <div class="section">
      <div class="agg-topbar">
        <div class="agg-subnav">
          <button class="agg-subtab-btn active" data-agg-tab-target="summary">Tabellino</button>
          <button class="agg-subtab-btn" data-agg-tab-target="second">Alzate</button>
          <button class="agg-subtab-btn" data-agg-tab-target="trajectory">Traiettorie</button>
          <button class="agg-subtab-btn" data-agg-tab-target="serve">Battute</button>
          <button class="agg-subtab-btn" data-agg-tab-target="player">Giocatrici</button>
        </div>
        <div class="analysis-filters analysis-team-filter analysis-team-filter--summary">
          <div class="analysis-filter">
            <div class="analysis-filter__label">Squadra</div>
            <div class="analysis-filter__row">
              <div id="analysis-filter-teams" class="analysis-filter__options"></div>
            </div>
          </div>
          <div class="analysis-filter">
            <div class="analysis-filter__label">Set</div>
            <div class="analysis-filter__row">
              <div id="analysis-filter-sets" class="analysis-filter__options"></div>
              <button id="btn-open-multiscout" class="primary small" type="button">Utilizza dati di piu partite</button>
              <div id="analysis-score-summary" class="score-summary score-summary--inline">
                <div class="score-card">
                  <label>Punteggio totale</label>
                  <div id="agg-score" class="score-value">0 - 0</div>
                  <label class="score-set-label">Set vinti</label>
                  <div id="agg-set-score" class="score-value small">0 - 0</div>
                  <div id="agg-set-cards" class="score-sets cards"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="agg-subpanel active" data-agg-tab="summary">
        <p class="section-note">Clicca una giocatrice per aprire l‚Äôanalisi individuale oppure un fondamentale per vederne i dettagli.</p>
        <div class="table-wrapper">
          <table class="agg-table">
            <thead>
              <tr>
                <th rowspan="2">Atleta</th>
                <th colspan="4">Punti</th>
                <th colspan="5" class="skill-col skill-serve">Battuta</th>
                <th colspan="5" class="skill-col skill-pass">Ricezione</th>
                <th colspan="6" class="skill-col skill-attack">Attacco</th>
                <th colspan="2" class="skill-col skill-block">Muro</th>
                <th colspan="3" class="skill-col skill-defense">Difesa</th>
              </tr>
              <tr>
                <th>Fatti</th>
                <th>Subiti</th>
                <th>Œî</th>
                <th>Falli/Errori</th>

                <th class="skill-col skill-serve">Tot</th>
                <th class="skill-col skill-serve">Err</th>
                <th class="skill-col skill-serve">Punti</th>
                <th class="skill-col skill-serve">Eff</th>
                <th class="skill-col skill-serve">Pos</th>

                <th class="skill-col skill-pass">Tot</th>
                <th class="skill-col skill-pass">Err</th>
                <th class="skill-col skill-pass">Pos</th>
                <th class="skill-col skill-pass">Prf</th>
                <th class="skill-col skill-pass">Eff</th>

                <th class="skill-col skill-attack">Tot</th>
                <th class="skill-col skill-attack">Err</th>
                <th class="skill-col skill-attack">Mur</th>
                <th class="skill-col skill-attack">Punti</th>
                <th class="skill-col skill-attack">% Punti</th>
                <th class="skill-col skill-attack">Eff</th>

                <th class="skill-col skill-block">Tot</th>
                <th class="skill-col skill-block">Punti</th>

                <th class="skill-col skill-defense">Tot</th>
                <th class="skill-col skill-defense">Err</th>
                <th class="skill-col skill-defense">Eff</th>
              </tr>
            </thead>
            <tbody id="agg-table-body">
              <tr>
                <td colspan="26">Registra alcuni eventi per vedere le statistiche aggregate.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="table-wrapper">
          <table class="agg-table">
            <tbody id="agg-summary-extra-body"></tbody>
          </table>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="trajectory">
        <div class="trajectory-layout">
          <div class="analysis-filters trajectory-filters">
            <div class="analysis-filter">
              <div class="analysis-filter__label">Alzatrice</div>
              <div id="traj-filter-setters" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Giocatrici</div>
              <div id="traj-filter-players" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Set</div>
              <div id="traj-filter-sets" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Tipo alzata</div>
              <div id="traj-filter-set-types" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Base</div>
              <div id="traj-filter-bases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Fase (SO/BP)</div>
              <div id="traj-filter-phases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione rice</div>
              <div id="traj-filter-receive-evals" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona ricezione</div>
              <div id="traj-filter-receive-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione attacco</div>
              <div id="traj-filter-codes" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona partenza</div>
              <div id="traj-filter-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Skill precedente</div>
              <select id="traj-filter-prev">
                <option value="any">Tutte</option>
                <option value="freeball-positive">Freeball o ricezione positiva</option>
                <option value="defense-negative">Difesa + ricezione negativa</option>
                <option value="freeball-only">Solo freeball</option>
                <option value="dig-only">Solo difesa</option>
              </select>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Campo</div>
              <div id="traj-court-side" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter filter-actions">
              <button id="traj-filter-reset" class="secondary small" type="button">Reset filtri</button>
            </div>
          </div>
          <div id="trajectory-grid" class="trajectory-grid">
            <div class="trajectory-card traj-area-z4" data-zone="4">
              <div class="trajectory-card__title">Zona 4</div>
              <canvas data-traj-canvas="4"></canvas>
              <div class="trajectory-card__empty">Nessuna traiettoria</div>
            </div>
          <div class="trajectory-card traj-area-z3" data-zone="3">
            <div class="trajectory-card__title">Zona 3</div>
            <canvas data-traj-canvas="3"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z2" data-zone="2">
            <div class="trajectory-card__title">Zona 2</div>
            <canvas data-traj-canvas="2"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z5" data-zone="5">
            <div class="trajectory-card__title">Zona 5</div>
            <canvas data-traj-canvas="5"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z6" data-zone="6">
            <div class="trajectory-card__title">Zona 6</div>
            <canvas data-traj-canvas="6"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
            <div class="trajectory-card traj-area-z1" data-zone="1">
              <div class="trajectory-card__title">Zona 1</div>
              <canvas data-traj-canvas="1"></canvas>
              <div class="trajectory-card__empty">Nessuna traiettoria</div>
            </div>
          </div>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="serve">
        <div class="trajectory-layout serve-trajectory-layout">
          <div class="analysis-filters trajectory-filters">
            <div class="analysis-filter">
              <div class="analysis-filter__label">Giocatrici</div>
              <div id="serve-traj-filter-players" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Set</div>
              <div id="serve-traj-filter-sets" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Tipo alzata</div>
              <div id="serve-traj-filter-set-types" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Base</div>
              <div id="serve-traj-filter-bases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Fase (SO/BP)</div>
              <div id="serve-traj-filter-phases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione rice</div>
              <div id="serve-traj-filter-receive-evals" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona ricezione</div>
              <div id="serve-traj-filter-receive-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione battuta</div>
              <div id="serve-traj-filter-codes" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona partenza</div>
              <div id="serve-traj-filter-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Campo</div>
              <div id="serve-traj-court-side" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter filter-actions">
              <button id="serve-traj-filter-reset" class="secondary small" type="button">Reset filtri</button>
            </div>
          </div>
          <div id="serve-trajectory-grid" class="trajectory-grid serve-trajectory-grid">
          </div>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="second">
        <div class="second-layout">
          <div class="analysis-filters" id="second-filters">
            <div class="analysis-filter">
              <div class="analysis-filter__label">Alzatrice</div>
              <div id="second-filter-setters" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Giocatrici</div>
              <div id="second-filter-players" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Set</div>
              <div id="second-filter-sets" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Tipo alzata</div>
              <div id="second-filter-set-types" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Base</div>
              <div id="second-filter-bases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Fase (SO/BP)</div>
              <div id="second-filter-phases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione rice</div>
              <div id="second-filter-receive-evals" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona ricezione</div>
              <div id="second-filter-receive-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione attacco</div>
              <div id="second-filter-codes" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona partenza</div>
              <div id="second-filter-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Skill precedente</div>
              <select id="second-filter-prev">
                <option value="any">Tutte</option>
                <option value="freeball-positive">Freeball o ricezione positiva</option>
                <option value="defense-negative">Difesa + ricezione negativa</option>
                <option value="freeball-only">Solo freeball</option>
                <option value="dig-only">Solo difesa</option>
              </select>
            </div>
            <div class="analysis-filter filter-actions">
              <button id="second-filter-reset" class="secondary small" type="button">Reset filtri</button>
            </div>
          </div>
          <div class="distribution-section">
            <h3>Distribuzione alzate per rotazione</h3>
            <div id="second-distribution" class="distribution-grid"></div>
          </div>
        </div>
          <div class="table-wrapper">
            <table class="agg-table">
            <thead>
              <tr>
                <th>Alzatrice</th>
                <th class="skill-col skill-second">Tot</th>
                <th class="skill-col skill-second">#</th>
                <th class="skill-col skill-second">+</th>
                <th class="skill-col skill-second">!</th>
                <th class="skill-col skill-second">-</th>
                <th class="skill-col skill-second">=</th>
                <th class="skill-col skill-second">/</th>
                <th class="skill-col skill-second">Pos</th>
                <th class="skill-col skill-second">Prf</th>
                <th class="skill-col skill-second">Eff</th>
              </tr>
            </thead>
            <tbody id="agg-second-body">
              <tr>
                <td colspan="11">Registra alzate per vedere il dettaglio.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="player">
          <div class="player-analysis">
            <div class="player-analysis-controls">
              <div class="analysis-filter">
                <div class="analysis-filter__label">Giocatrice</div>
                <select id="player-analysis-select"></select>
              </div>
              <div class="analysis-filter">
                <div class="analysis-filter__label">Campo</div>
                <div id="player-analysis-court-side" class="analysis-filter__options"></div>
              </div>
              <div class="player-analysis-toggles">
                <label class="analysis-toggle">
                  <input type="checkbox" id="player-analysis-show-attack" checked />
                Traiettorie attacco
              </label>
              <label class="analysis-toggle">
                <input type="checkbox" id="player-analysis-show-serve" checked />
                Traiettorie battute
              </label>
              <label class="analysis-toggle">
                <input type="checkbox" id="player-analysis-show-second" />
                Distribuzione alzate
              </label>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="agg-table player-analysis-table">
              <thead>
                <tr>
                  <th rowspan="2">Atleta</th>
                  <th colspan="4">Punti</th>
                  <th colspan="5" class="skill-col skill-serve">Battuta</th>
                  <th colspan="5" class="skill-col skill-pass">Ricezione</th>
                  <th colspan="6" class="skill-col skill-attack">Attacco</th>
                  <th colspan="2" class="skill-col skill-block">Muro</th>
                  <th colspan="3" class="skill-col skill-defense">Difesa</th>
                </tr>
                <tr>
                  <th>Fatti</th>
                  <th>Subiti</th>
                  <th>Œî</th>
                  <th>Falli/Errori</th>

                  <th class="skill-col skill-serve">Tot</th>
                  <th class="skill-col skill-serve">Err</th>
                  <th class="skill-col skill-serve">Punti</th>
                  <th class="skill-col skill-serve">Eff</th>
                  <th class="skill-col skill-serve">Pos</th>

                  <th class="skill-col skill-pass">Tot</th>
                  <th class="skill-col skill-pass">Err</th>
                  <th class="skill-col skill-pass">Pos</th>
                  <th class="skill-col skill-pass">Prf</th>
                  <th class="skill-col skill-pass">Eff</th>

                  <th class="skill-col skill-attack">Tot</th>
                  <th class="skill-col skill-attack">Err</th>
                  <th class="skill-col skill-attack">Mur</th>
                  <th class="skill-col skill-attack">Punti</th>
                  <th class="skill-col skill-attack">% Punti</th>
                  <th class="skill-col skill-attack">Eff</th>

                  <th class="skill-col skill-block">Tot</th>
                  <th class="skill-col skill-block">Punti</th>

                  <th class="skill-col skill-defense">Tot</th>
                  <th class="skill-col skill-defense">Err</th>
                  <th class="skill-col skill-defense">Eff</th>
                </tr>
              </thead>
              <tbody id="player-analysis-body">
                <tr>
                  <td colspan="26">Seleziona una giocatrice per vedere il tabellino.</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="player-analysis-columns">
            <div id="player-analysis-attack" class="player-analysis-section">
              <div class="player-analysis-column">
                <div class="trajectory-layout">
                  <div id="player-trajectory-grid" class="trajectory-grid">
                    <div class="trajectory-card traj-area-z4" data-zone="4">
                      <div class="trajectory-card__title">Zona 4</div>
                      <canvas data-traj-canvas="4"></canvas>
                      <div class="trajectory-card__empty">Nessuna traiettoria</div>
                    </div>
                  <div class="trajectory-card traj-area-z3" data-zone="3">
                    <div class="trajectory-card__title">Zona 3</div>
                    <canvas data-traj-canvas="3"></canvas>
                    <div class="trajectory-card__empty">Nessuna traiettoria</div>
                  </div>
                  <div class="trajectory-card traj-area-z2" data-zone="2">
                    <div class="trajectory-card__title">Zona 2</div>
                    <canvas data-traj-canvas="2"></canvas>
                    <div class="trajectory-card__empty">Nessuna traiettoria</div>
                  </div>
                  <div class="trajectory-card traj-area-z5" data-zone="5">
                    <div class="trajectory-card__title">Zona 5</div>
                    <canvas data-traj-canvas="5"></canvas>
                    <div class="trajectory-card__empty">Nessuna traiettoria</div>
                  </div>
                  <div class="trajectory-card traj-area-z6" data-zone="6">
                    <div class="trajectory-card__title">Zona 6</div>
                    <canvas data-traj-canvas="6"></canvas>
                    <div class="trajectory-card__empty">Nessuna traiettoria</div>
                  </div>
                    <div class="trajectory-card traj-area-z1" data-zone="1">
                      <div class="trajectory-card__title">Zona 1</div>
                      <canvas data-traj-canvas="1"></canvas>
                      <div class="trajectory-card__empty">Nessuna traiettoria</div>
                    </div>
                  </div>
                  <div class="analysis-filters trajectory-filters">
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Set</div>
                      <div id="player-traj-filter-sets" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Tipo alzata</div>
                      <div id="player-traj-filter-set-types" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Base</div>
                      <div id="player-traj-filter-bases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Fase (SO/BP)</div>
                      <div id="player-traj-filter-phases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Valutazione rice</div>
                      <div id="player-traj-filter-receive-evals" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Zona ricezione</div>
                      <div id="player-traj-filter-receive-zones" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Valutazione attacco</div>
                      <div id="player-traj-filter-codes" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Zona partenza</div>
                      <div id="player-traj-filter-zones" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Skill precedente</div>
                      <select id="player-traj-filter-prev">
                        <option value="any">Tutte</option>
                        <option value="freeball-positive">Freeball o ricezione positiva</option>
                        <option value="defense-negative">Difesa + ricezione negativa</option>
                        <option value="freeball-only">Solo freeball</option>
                        <option value="dig-only">Solo difesa</option>
                      </select>
                    </div>
                    <div class="analysis-filter filter-actions">
                      <button id="player-traj-filter-reset" class="secondary small" type="button">Reset filtri</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div id="player-analysis-serve" class="player-analysis-section">
              <div class="player-analysis-column">
                <div class="trajectory-layout serve-trajectory-layout">
                  <div id="player-serve-trajectory-grid" class="trajectory-grid serve-trajectory-grid"></div>
                  <div class="analysis-filters trajectory-filters">
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Set</div>
                      <div id="player-serve-traj-filter-sets" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Tipo alzata</div>
                      <div id="player-serve-traj-filter-set-types" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Base</div>
                      <div id="player-serve-traj-filter-bases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Fase (SO/BP)</div>
                      <div id="player-serve-traj-filter-phases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Valutazione rice</div>
                      <div id="player-serve-traj-filter-receive-evals" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Zona ricezione</div>
                      <div id="player-serve-traj-filter-receive-zones" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Valutazione battuta</div>
                      <div id="player-serve-traj-filter-codes" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Zona partenza</div>
                      <div id="player-serve-traj-filter-zones" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter filter-actions">
                      <button id="player-serve-traj-filter-reset" class="secondary small" type="button">Reset filtri</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div id="player-analysis-second" class="player-analysis-section">
              <div class="player-analysis-column">
                <div class="second-layout player-second-layout">
                  <div id="player-second-distribution" class="distribution-grid"></div>
                  <div class="table-wrapper">
                    <table class="agg-table">
                      <thead>
                        <tr>
                          <th>Alzate</th>
                          <th class="skill-col skill-second">Tot</th>
                          <th class="skill-col skill-second">#</th>
                          <th class="skill-col skill-second">+</th>
                          <th class="skill-col skill-second">!</th>
                          <th class="skill-col skill-second">-</th>
                          <th class="skill-col skill-second">=</th>
                          <th class="skill-col skill-second">/</th>
                          <th class="skill-col skill-second">Pos</th>
                          <th class="skill-col skill-second">Prf</th>
                          <th class="skill-col skill-second">Eff</th>
                        </tr>
                      </thead>
                      <tbody id="player-second-body">
                        <tr>
                          <td colspan="11">Seleziona una giocatrice per vedere la distribuzione.</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="analysis-filters" id="player-second-filters">
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Tipo alzata</div>
                      <div id="player-second-filter-set-types" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Base</div>
                      <div id="player-second-filter-bases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Fase (SO/BP)</div>
                      <div id="player-second-filter-phases" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Valutazione rice</div>
                      <div id="player-second-filter-receive-evals" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Zona ricezione</div>
                      <div id="player-second-filter-receive-zones" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Set</div>
                      <div id="player-second-filter-sets" class="analysis-filter__options"></div>
                    </div>
                    <div class="analysis-filter">
                      <div class="analysis-filter__label">Skill precedente</div>
                      <select id="player-second-filter-prev">
                        <option value="any">Tutte</option>
                        <option value="freeball-positive">Freeball o ricezione positiva</option>
                        <option value="defense-negative">Difesa + ricezione negativa</option>
                        <option value="freeball-only">Solo freeball</option>
                        <option value="dig-only">Solo difesa</option>
                      </select>
                    </div>
                    <div class="analysis-filter filter-actions">
                      <button id="player-second-filter-reset" class="secondary small" type="button">Reset filtri</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="controls-row agg-actions">
        <button id="btn-export-pdf" class="secondary">Stampa / PDF</button>
        <button id="btn-export-html" class="secondary">Esporta HTML</button>
      </div>
    </div>
  </div>
  <div class="tab-panel" data-tab="video" id="video-panel">
    <div id="video-analysis-host">
      <div class="section video-analysis" id="video-analysis-section">
        <div class="video-analysis__head">
          <div>
            <h2>Analisi video</h2>
            <p class="section-note">Carica un video e sincronizza le skill registrate per saltare al momento corretto.</p>
          </div>
        </div>
      <div class="video-analysis__grid">
        <div class="video-skills">
          <div class="table-wrapper video-table-wrapper">
            <div id="video-skills-container"></div>
          </div>
          <div class="video-analysis__footer-actions">
            <button id="btn-fix-video-score" class="secondary" type="button">Correggi punteggio</button>
            <button id="btn-video-add-event" class="secondary" type="button">Aggiungi evento</button>
            <button id="btn-offset-skills" class="secondary">Offset skill</button>
            <button id="btn-unify-times" class="secondary">Unifica tempi</button>
            <button id="btn-skill-duration" class="secondary">Durata skill</button>
            <button id="btn-video-undo" class="danger">Annulla ultima</button>
          </div>
        </div>
        <div class="video-player-wrap">
          <div class="video-analysis__actions">
            <label class="file-btn" for="video-file-input">Carica video</label>
            <input id="video-file-input" type="file" accept="video/*" hidden />
            <button id="btn-sync-first-skill" class="secondary">Sincronizza prima skill</button>
            <button id="btn-copy-ffmpeg" class="secondary">Copia ffmpeg (selezione)</button>
            <label class="auto-rotate-toggle">
              <input type="checkbox" id="video-playbyplay-toggle" />
              Play by play
            </label>
            <div class="youtube-input">
              <input id="youtube-url-input" type="url" placeholder="https://youtu.be/..." />
              <button id="btn-load-youtube" class="secondary">Usa YouTube</button>
            </div>
          </div>
          <div class="video-media">
            <div id="video-analysis-overlay" class="video-overlay hidden" aria-hidden="true">
              <div id="video-overlay-set" class="video-overlay-line"></div>
              <div id="video-overlay-player" class="video-overlay-line"></div>
              <div id="video-overlay-skill" class="video-overlay-line"></div>
              <div id="video-overlay-rotation" class="video-overlay-line"></div>
            </div>
            <video id="analysis-video" controls preload="metadata"></video>
            <iframe
              id="youtube-frame"
              class="youtube-frame"
              title="YouTube player"
              tabindex="-1"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen
            ></iframe>
            <div class="youtube-focus-guard" data-youtube-guard></div>
          </div>
          <p class="section-note">Seleziona una skill per spostarti al timestamp calcolato. Puoi usare un file o un link YouTube.
            <br>Shortcuts:
            <ul>
            <li>spazio play/pausa, frecce sinistra/destra ¬±3s, shift+frecce sinistra/destra frame-by-frame.</li>
            <li>Q-W diminuisci/aumenta il timestamp della skill attuale di 0.5s</li>
          </ul>


            <br></p>
        </div>
      </div>
      <div class="video-filters-panel">
        <div class="video-filters-header">Filtri</div>
        <div class="analysis-filters" id="video-filters">
        <div class="analysis-filter">
          <div class="analysis-filter__label">Squadra</div>
          <div id="video-filter-teams" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Giocatrici</div>
          <div id="video-filter-players" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Alzatore</div>
          <div id="video-filter-setters" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Fondamentale</div>
          <div id="video-filter-skills" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Codice</div>
          <div id="video-filter-codes" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Set</div>
          <div id="video-filter-sets" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Rotazione</div>
          <div id="video-filter-rotations" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Zona</div>
          <div id="video-filter-zones" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Base</div>
          <div id="video-filter-bases" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Tipo alzata</div>
          <div id="video-filter-set-types" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Fase (SO/BP)</div>
          <div id="video-filter-phases" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Valutazione rice</div>
          <div id="video-filter-receive-evals" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Zona ricezione</div>
          <div id="video-filter-receive-zones" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter">
          <div class="analysis-filter__label">Tipo servizio</div>
          <div id="video-filter-serve-types" class="analysis-filter__options"></div>
        </div>
        <div class="analysis-filter filter-actions">
          <button id="video-filter-reset" class="secondary small" type="button">Reset filtri</button>
        </div>
        </div>
      </div>
      </div>
    </div>
  </div>
  <noscript>Questa applicazione richiede JavaScript abilitato.</noscript>
  <div id="team-manager-modal" class="team-modal hidden" role="dialog" aria-modal="true">
    <div class="team-modal__backdrop"></div>
    <div class="team-modal__dialog">
      <div class="team-modal__head">
        <h3>Gestione squadra</h3>
        <button id="team-manager-close" aria-label="Chiudi" class="icon-button">‚úï</button>
      </div>
      <div class="team-modal__content">
        <div class="team-meta-grid">
          <label>Nome squadra
            <input type="text" id="team-meta-name" placeholder="Nome squadra" />
          </label>
          <label>Head coach
            <input type="text" id="team-meta-head" placeholder="Allenatore" />
          </label>
          <label>Vice
            <input type="text" id="team-meta-assistant" placeholder="Assistente" />
          </label>
          <label>Dirigente
            <input type="text" id="team-meta-manager" placeholder="Dirigente" />
          </label>
        </div>
        <p class="section-note">Imposta staff, capitana (K), liberi (L) e chi √® fuori rosa. La formazione di default si gestisce dal pannello a destra. I ruoli in campo sono sempre inferiti automaticamente dalla posizione del palleggiatore nella rotazione reale.</p>
        <div class="team-manager-actions">
          <button id="team-manager-add" class="secondary">Aggiungi giocatrice</button>
          <button id="btn-open-players-paste" class="secondary">Incolla elenco</button>
          <button id="team-manager-template" class="secondary hidden">Genera squadra di default</button>
        </div>
        <div class="team-manager-roster-layout">
          <div class="team-manager-roster">
            <div class="table-wrapper team-manager-tablewrap">
              <table class="team-manager-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Cognome</th>
                    <th>Nome</th>
                    <th>Capitano</th>
                    <th>Libero</th>
                    <th>Fuori rosa</th>
                    <th>ID</th>
                    <th>Azioni</th>
                  </tr>
                </thead>
                <tbody id="team-manager-body"></tbody>
              </table>
            </div>
          </div>
          <div class="team-manager-default">
            <h4>Formazione di default</h4>
            <label class="default-lineup-rotation">
              <span>Rotazione iniziale</span>
              <div class="rotation-controls default-lineup-rotation-controls">
                <button id="default-lineup-rotate-cw" class="small rotate-cw" type="button">‚Ü∫</button>
                <div class="rotation-display">
                  <select id="default-lineup-rotation" class="rotation-select">
                    <option value="1">P1</option>
                    <option value="2">P2</option>
                    <option value="3">P3</option>
                    <option value="4">P4</option>
                    <option value="5">P5</option>
                    <option value="6">P6</option>
                  </select>
                </div>
                <button id="default-lineup-rotate-ccw" class="small rotate-ccw" type="button">‚Üª</button>
              </div>
            </label>
            <label class="default-lineup-preferred-libero">
              <span>Libero principale</span>
              <select id="default-lineup-preferred-libero" class="rotation-select"></select>
            </label>
            <div id="default-lineup-grid" class="default-lineup-grid"></div>
            <div class="default-lineup-bench">
              <div class="default-lineup-bench__title">Giocatrici disponibili</div>
              <div id="default-lineup-bench" class="default-lineup-bench__list"></div>
            </div>
          </div>
        </div>
        <div class="team-manager-footer">
          <button id="btn-export-team" class="secondary">Esporta su file</button>
          <button id="team-manager-cancel" class="secondary">Annulla</button>
          <button id="team-manager-save" class="primary">Salva</button>
        </div>
      </div>
    </div>
  </div>
  <div id="paste-players-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="paste-players-title">
    <div class="settings-modal__backdrop" data-close-paste></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="paste-players-title">Incolla elenco giocatrici</h3>
        <button class="pill-remove" aria-label="Chiudi" data-close-paste>‚úï</button>
      </div>
      <div class="settings-modal__body">
        <label for="players-input">Formato: Cognome Nome;Numero;L (L opzionale per il libero). Sono accettati anche tab o spazi.</label>
        <textarea id="players-input" placeholder="Esempi:
Rossi Martina;12;L
Verdi Sara;7
Bianchi Laura 18"></textarea>
        <div class="controls-row">
          <button id="btn-apply-players">Aggiungi elenco</button>
          <button class="secondary" data-close-paste>Annulla</button>
        </div>
      </div>
    </div>
  </div>
  <div id="skill-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-skill onclick="window._closeSkillModal && window._closeSkillModal()"></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="skill-modal-title" class="skill-modal__title"></div>
        <button id="skill-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-skill="true" onclick="window._closeSkillModal && window._closeSkillModal()">‚úï</button>
      </div>
      <div id="skill-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="agg-skill-modal" class="skill-modal hidden force-popup" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-agg-skill></div>
    <div class="skill-modal__content agg-skill-modal__content">
      <div class="skill-modal__head">
        <div id="agg-skill-modal-title" class="skill-modal__title"></div>
        <button id="agg-skill-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-agg-skill="true">‚úï</button>
      </div>
      <div id="agg-skill-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="base-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-base></div>
    <div class="skill-modal__content base-modal__content">
      <div class="skill-modal__head">
        <div class="skill-modal__title">Base centrale</div>
        <button id="base-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-base="true">‚úï</button>
      </div>
      <div class="skill-modal__body">
        <p class="section-note">Seleziona la base da assegnare all'ultimo attacco.</p>
        <div id="base-modal-grid" class="base-modal__grid">
          <button type="button" class="base-modal-btn" data-base="K1" data-key="1">K1</button>
          <button type="button" class="base-modal-btn" data-base="K2" data-key="2">K2</button>
          <button type="button" class="base-modal-btn" data-base="KC" data-key="C">KC</button>
          <button type="button" class="base-modal-btn" data-base="KB" data-key="B">KB</button>
          <button type="button" class="base-modal-btn" data-base="K7" data-key="7">K7</button>
          <button type="button" class="base-modal-btn" data-base="KF" data-key="F">KF</button>
        </div>
        <div class="section-note base-modal__hint">Scorciatoie: 1, 2, C, B, 7, F.</div>
      </div>
    </div>
  </div>
  <div id="attack-type-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-attack-type></div>
    <div class="skill-modal__content base-modal__content">
      <div class="skill-modal__head">
        <div class="skill-modal__title">Tipo attacco</div>
        <button id="attack-type-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-attack-type="true">‚úï</button>
      </div>
      <div class="skill-modal__body">
        <p class="section-note">Seleziona il tipo di attacco da assegnare all'ultimo attacco.</p>
        <div id="attack-type-modal-grid" class="base-modal__grid">
          <button type="button" class="base-modal-btn" data-attack-type="Regolare" data-key="R">Regolare (R)</button>
          <button type="button" class="base-modal-btn" data-attack-type="Pallonetto" data-key="P">Pallonetto (P)</button>
          <button type="button" class="base-modal-btn" data-attack-type="Piazzata" data-key="Z">Piazzata (Z)</button>
          <button type="button" class="base-modal-btn" data-attack-type="Spinta" data-key="S">Spinta (S)</button>
        </div>
        <div class="section-note base-modal__hint">Scorciatoie: R, P, Z, S.</div>
      </div>
    </div>
  </div>
  <div id="block-number-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-block-number></div>
    <div class="skill-modal__content base-modal__content">
      <div class="skill-modal__head">
        <div class="skill-modal__title">N¬∞ muro</div>
        <button id="block-number-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-block-number="true">‚úï</button>
      </div>
      <div class="skill-modal__body">
        <p class="section-note">Seleziona il numero di giocatrici a muro per l'ultimo attacco.</p>
        <div id="block-number-modal-grid" class="base-modal__grid">
          <button type="button" class="base-modal-btn" data-block-number="0" data-key="0">0</button>
          <button type="button" class="base-modal-btn" data-block-number="1" data-key="1">1</button>
          <button type="button" class="base-modal-btn" data-block-number="2" data-key="2">2</button>
          <button type="button" class="base-modal-btn" data-block-number="3" data-key="3">3</button>
        </div>
        <div class="section-note base-modal__hint">Scorciatoie: 0, 1, 2, 3.</div>
      </div>
    </div>
  </div>
  <div id="bulk-edit-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-bulk></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="bulk-edit-title" class="skill-modal__title">Modifica multipla</div>
        <button id="bulk-edit-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div class="skill-modal__body">
        <p id="bulk-edit-hint" class="section-note"></p>
        <div id="bulk-edit-body"></div>
        <div class="settings-actions">
          <button id="bulk-edit-cancel" class="secondary" type="button">Annulla</button>
          <button id="bulk-edit-apply" class="primary" type="button">Salva</button>
        </div>
      </div>
    </div>
  </div>
  <div id="video-score-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-video-score></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div class="skill-modal__title">Correggi punteggio</div>
        <button id="video-score-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div class="skill-modal__body">
        <div class="video-score-form">
          <label for="video-score-home">Punteggio nostro</label>
          <input id="video-score-home" type="number" min="0" step="1" />
          <label for="video-score-away">Punteggio avversario</label>
          <input id="video-score-away" type="number" min="0" step="1" />
        </div>
        <div class="settings-actions">
          <button id="video-score-cancel" class="secondary" type="button">Annulla</button>
          <button id="video-score-apply" class="primary" type="button">Applica</button>
        </div>
      </div>
    </div>
  </div>
  <div id="set-start-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="set-start-modal-title">
      <div class="skill-modal__content">
        <div class="skill-modal__head">
          <h3 id="set-start-modal-title">Formazione di partenza</h3>
          <button id="set-start-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
        </div>
        <div id="set-start-modal-body" class="skill-modal__body"></div>
        <div class="skill-modal__foot">
          <button id="set-start-modal-cancel" class="secondary">Chiudi</button>
        </div>
      </div>
    </div>
  <div id="lineup-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="lineup-modal-title">
    <div class="skill-modal__backdrop" data-close-lineup></div>
    <div class="skill-modal__content lineup-modal__content">
      <div class="skill-modal__head">
        <h3 id="lineup-modal-title">Imposta formazione</h3>
        <button id="lineup-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div class="lineup-modal__body">
        <div class="lineup-modal__court">
          <div id="lineup-modal-court" class="lineup-court-grid"></div>
        </div>
        <div class="lineup-modal__bench">
          <h4>Panchina</h4>
          <div id="lineup-modal-bench" class="lineup-bench-chips"></div>
        </div>
      </div>
      <div class="lineup-modal__foot">
        <div class="lineup-modal__libero">
          <span>Libero principale</span>
          <select id="lineup-preferred-libero"></select>
        </div>
        <button id="lineup-modal-apply-default" class="secondary">Inserisci formazione default</button>
        <button id="lineup-modal-toggle-numbers" class="secondary">Modalit√† numeri</button>
        <button id="lineup-modal-save-override">Metti in campo (Override)</button>
        <button id="lineup-modal-save-substitution" class="danger">Effettua sostituzioni</button>
        <button id="lineup-modal-cancel" class="secondary">Chiudi</button>
      </div>
    </div>
  </div>
  <div id="error-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="error-modal-title">
    <div class="skill-modal__backdrop" data-close-error></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="error-modal-title" class="skill-modal__title">Assegna errore/fallo</div>
        <button id="error-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div id="error-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="point-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="point-modal-title">
    <div class="skill-modal__backdrop" data-close-point></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="point-modal-title" class="skill-modal__title">Assegna punto</div>
        <button id="point-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div id="point-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="attack-trajectory-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="attack-trajectory-title">
    <div class="skill-modal__backdrop" data-close-trajectory></div>
    <div class="skill-modal__content attack-trajectory-content">
      <div class="attack-trajectory-body">
        <div class="attack-trajectory-stage">
          <img id="attack-trajectory-image" alt="Campo per traiettoria" />
          <canvas id="attack-trajectory-canvas"></canvas>
        </div>
        <div id="attack-trajectory-netpoints" class="attack-trajectory-netpoints hidden" aria-label="Punti rete attacco">
          <span class="attack-trajectory-netpoints-label">Punto rete</span>
          <button type="button" data-net-point="5" style="--net-x: 0.1667">5</button>
          <button type="button" data-net-point="7-9" style="--net-x: 0.3333">7-9</button>
          <button type="button" data-net-point="3" style="--net-x: 0.5">3</button>
          <button type="button" data-net-point="4" style="--net-x: 0.6667">4</button>
          <button type="button" data-net-point="6-F" style="--net-x: 0.8333">6-F</button>
        </div>
      </div>
          <div class="attack-trajectory-actions">
            <div class="attack-trajectory-info">
              <div id="attack-trajectory-instructions" class="attack-trajectory-instructions"></div>
              <div id="serve-type-buttons" class="serve-type-buttons hidden" role="group" aria-label="Tipo battuta">
                <button type="button" data-serve-type="F">Float (F)</button>
                <button type="button" data-serve-type="JF" class="active">Jump float (JF)</button>
                <button type="button" data-serve-type="S">Spin (S)</button>
              </div>
            </div>
            <button id="attack-trajectory-close-btn" class="pill-remove" type="button" aria-label="Chiudi">‚úï</button>
          </div>
    </div>
  </div>
  <div id="match-manager-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="match-manager-title">
    <div class="settings-modal__backdrop" data-close-match-manager></div>
    <div class="settings-modal__content match-manager__content">
      <div class="settings-modal__head">
        <h3 id="match-manager-title">Gestione match</h3>
        <button id="match-manager-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body match-manager__body">
        <div class="match-manager-grid">
          <div class="match-manager-panel">
            <h4>Informazioni match</h4>
            <div class="top-bar match-form-grid">
              <div class="col">
                <label for="match-opponent">Avversario</label>
                <input id="match-opponent" type="text" />
              </div>
              <div class="col">
                <label for="match-category">Categoria</label>
                <input id="match-category" type="text" />
              </div>
              <div class="col">
                <label for="match-date">Data</label>
                <input id="match-date" type="date" />
              </div>
              <div class="col">
                <label for="match-type">Tipo partita</label>
                <select id="match-type">
                  <option value="amichevole">Amichevole</option>
                  <option value="campionato">Campionato</option>
                  <option value="torneo">Torneo</option>
                  <option value="playoff">Playoff</option>
                  <option value="playout">Playout</option>
                  <option value="coppa">Coppa</option>
                  <option value="">Altro</option>
                </select>
              </div>
              <div class="col">
                <label for="match-leg">Turno</label>
                <select id="match-leg">
                  <option value="">-</option>
                  <option value="andata">Andata</option>
                  <option value="ritorno">Ritorno</option>
                  <option value="gara-1">Gara 1</option>
                  <option value="gara-2">Gara 2</option>
                  <option value="gara-3">Gara 3</option>
                </select>
              </div>
            </div>
            <div class="controls-row">
              <button id="btn-save-match-info">Salva info match</button>
            </div>
          </div>
          <div class="match-manager-panel">
            <h4>Match salvati</h4>
            <div id="saved-matches-list" class="match-list" role="listbox" aria-label="Match salvati"></div>
            <select id="saved-matches" class="hidden-select" tabindex="-1" aria-hidden="true">
              <option value="">Nuovo match (vuoto)</option>
            </select>
            <div class="controls-row">
              <button id="btn-load-match">Carica match</button>
              <button id="btn-new-match" class="secondary">Nuovo match</button>
              <button id="btn-delete-match" class="danger">Elimina selezionati</button>
            </div>
          </div>
          <div class="match-manager-panel">
            <h4>Azioni match</h4>
            <div class="controls-row">
              <button id="btn-reset-match" class="danger">Reset match</button>
              <button id="btn-export-match" class="secondary">Esporta match</button>
              <button id="btn-import-match" class="secondary">Importa match</button>
              <input id="match-file-input" type="file" accept="application/json,text/plain" hidden />
            </div>
            <div class="controls-row">
              <button id="btn-export-db" class="secondary">Esporta database completo</button>
              <button id="btn-import-db" class="secondary">Importa database</button>
              <input id="db-file-input" type="file" accept="application/json,text/plain" hidden />
            </div>
            <p class="section-note">Backup di tutte le impostazioni, squadre e match attuale in un unico file.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="teams-manager-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="teams-manager-title">
    <div class="settings-modal__backdrop" data-close-teams-manager></div>
    <div class="settings-modal__content teams-manager__content">
      <div class="settings-modal__head">
        <h3 id="teams-manager-title">Gestione squadre</h3>
        <button id="teams-manager-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body teams-manager__body">
        <div class="teams-manager-row">
          <label>Squadre salvate</label>
          <ul id="teams-manager-list" class="teams-manager-list"></ul>
        </div>
        <div class="teams-manager-actions">
          <button id="btn-new-team" class="primary">Nuova squadra</button>
          <button id="teams-manager-delete" class="danger">Elimina</button>
          <button id="teams-manager-duplicate" class="secondary">Duplica</button>
          <button id="teams-manager-export" class="secondary">Esporta su file</button>
          <button id="teams-manager-import" class="secondary">Importa da file</button>
          <button id="teams-manager-open-players-db" class="secondary">Archivio giocatrici</button>
          <input id="teams-manager-file-input" type="file" accept="application/json,text/plain" hidden />
        </div>
        <p class="section-note">La selezione qui serve solo per gestire le squadre salvate.</p>
      </div>
    </div>
  </div>
  <div id="players-db-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="players-db-title">
    <div class="settings-modal__backdrop" data-close-players-db></div>
    <div class="settings-modal__content players-db__content">
      <div class="settings-modal__head">
        <h3 id="players-db-title">Archivio giocatrici</h3>
        <button id="players-db-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body players-db__body">
        <div class="players-db__summary">
          <span id="players-db-count"></span>
          <button id="btn-clean-players-db" class="secondary small">Rimuovi senza squadra</button>
        </div>
        <div class="table-wrapper players-db__tablewrap">
          <table class="players-db-table">
            <thead>
              <tr>
                <th>Cognome</th>
                <th>Nome</th>
                <th>Squadre</th>
                <th>ID</th>
              </tr>
            </thead>
            <tbody id="players-db-body"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div id="settings-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="settings-modal-title">
    <div class="settings-modal__backdrop" data-close-settings></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="settings-modal-title">Impostazioni automatismi</h3>
        <button id="settings-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <label class="auto-rotate-toggle">
          <input type="checkbox" id="auto-rotate-toggle-settings" />
          Rotazione automatica su cambio palla
        </label>
        <label class="auto-rotate-toggle">
          <input type="checkbox" id="auto-role-toggle-settings" />
          Auto posizionamento per ruolo
        </label>
        <label class="auto-rotate-toggle auto-libero-row">
          <span>Libero automatico</span>
          <div class="auto-libero-controls">
            <select id="auto-libero-select-settings">
              <option value="">Nessuno</option>
              <option value="P">P</option>
              <option value="S">S</option>
              <option value="C">C</option>
              <option value="O">O</option>
            </select>
            <button type="button" id="btn-swap-libero-settings" class="small secondary">Cambia libero</button>
          </div>
        </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="auto-role-p1american-toggle-settings" />
                  P1 americana (OH in 4, OP in 2 su cambio palla)
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="attack-trajectory-toggle-settings" />
                  Disegna traiettoria attacco
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="attack-trajectory-simple-toggle-settings" />
                  Direzione attacco semplificata
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="predictive-skill-toggle-settings" />
                  Flusso di gioco automatico
                </label>
      </div>
    </div>
  </div>
  <div id="offset-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="offset-modal-title">
    <div class="settings-modal__backdrop" data-close-offset></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="offset-modal-title">Offset video per skill (secondi)</h3>
        <button id="offset-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <div id="offset-skill-grid" class="offset-skill-grid"></div>
        <div class="offset-actions">
          <button id="offset-apply" class="small">Applica</button>
          <button class="small secondary" data-close-offset>Annulla</button>
        </div>
      </div>
    </div>
  </div>
  <div id="unify-times-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="unify-times-title">
    <div class="settings-modal__backdrop" data-close-unify-times></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="unify-times-title">Unifica tempi collegamenti</h3>
        <button id="unify-times-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <p class="section-note">Scegli quali collegamenti unificare e da quale evento prendere il tempo.</p>
        <div id="unify-times-grid" class="unify-times-grid"></div>
        <div class="offset-actions">
          <button id="unify-times-apply" class="small">Applica</button>
          <button class="small secondary" data-close-unify-times>Annulla</button>
        </div>
      </div>
    </div>
  </div>
  <div id="multiscout-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="multiscout-title">
    <div class="settings-modal__backdrop" data-close-multiscout></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="multiscout-title">Utilizza dati di piu partite</h3>
        <button id="multiscout-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <div class="analysis-filter multiscout-controls">
          <div class="analysis-filter__label">Squadra</div>
          <div class="analysis-filter__row">
            <select id="multiscout-team-select"></select>
          </div>
        </div>
        <div id="multiscout-subtitle" class="multiscout-subtitle"></div>
        <div id="multiscout-list" class="analysis-filter__options multiscout-list"></div>
        <div class="offset-actions">
          <button id="multiscout-reset" class="small secondary" type="button">Reset</button>
          <button id="multiscout-cancel" class="small secondary">Chiudi</button>
        </div>
      </div>
    </div>
  </div>
  <div id="skill-duration-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="skill-duration-title">
    <div class="settings-modal__backdrop" data-close-skill-duration></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="skill-duration-title">Durata skill (ms)</h3>
        <button id="skill-duration-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <p class="section-note">Imposta la durata di default per ogni fondamentale. Lo step √® 250 ms.</p>
        <div id="skill-duration-grid" class="offset-skill-grid"></div>
        <div class="offset-actions">
          <button id="skill-duration-apply" class="small">Applica</button>
          <button class="small secondary" data-close-skill-duration>Annulla</button>
        </div>
      </div>
    </div>
  </div>
  <button id="floating-serve-error-btn" class="floating-serve-error-btn hidden" type="button" aria-label="Battuta errore">=</button>
  <script src="js/globals.js"></script>
  <script src="js/shared/team-ui.js"></script>
  <script src="js/shared/lineup-core.js"></script>
  <script src="js/shared/auto-role.js"></script>
  <script src="js/shared/roster-manager.js"></script>
  <script src="js/match-settings.js"></script>
  <script src="js/opponent-settings.js"></script>
  <script src="js/roster-lineup.js"></script>
  <script src="js/scout-ui.js"></script>
</body>
</html>
