<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Simple Volleyball Scout PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#111111" />
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
</head>
<body>
  <div class="tabs-nav floating centered">
    <h1 class="app-title">Simple Volleyball Scout PWA</h1>
    <a class="manual-link-btn" href="manual.html">Manuale</a>
    <button class="tab-btn active" data-tab-target="info">Impostazioni partita</button>
    <button class="tab-btn" data-tab-target="scout">Scout live</button>
    <button class="tab-btn" data-tab-target="aggregated">Analisi</button>
    <button class="tab-btn" data-tab-target="video">Video</button>
  </div>
  <div class="tabs-dots" aria-label="Navigazione pagine">
    <button class="tab-btn tab-dot" data-tab-target="info" aria-label="Impostazioni partita"></button>
    <button class="tab-btn tab-dot" data-tab-target="scout" aria-label="Scout live"></button>
    <button class="tab-btn tab-dot" data-tab-target="aggregated" aria-label="Analisi"></button>
    <button class="tab-btn tab-dot" data-tab-target="video" aria-label="Video"></button>
  </div>
  <div class="tab-panel active" data-tab="info">
    <div class="section">
      <h2>Impostazioni partita</h2>
      <div class="top-bar">
        <div class="col">
          <label for="match-opponent">Avversario</label>
          <input id="match-opponent" type="text" />
        </div>
        <div class="col">
          <label for="match-category">Categoria</label>
          <input id="match-category" type="text" />
        </div>
        <div class="col">
          <label for="match-date">Data</label>
          <input id="match-date" type="date" />
        </div>
        <div class="col">
          <label for="match-type">Tipo partita</label>
          <select id="match-type">
            <option value="amichevole">Amichevole</option>
            <option value="campionato">Campionato</option>
            <option value="torneo">Torneo</option>
            <option value="playoff">Playoff</option>
            <option value="playout">Playout</option>
            <option value="coppa">Coppa</option>
            <option value="">Altro</option>
          </select>
        </div>
        <div class="col">
          <label for="match-leg">Turno</label>
          <select id="match-leg">
            <option value="">-</option>
            <option value="andata">Andata</option>
            <option value="ritorno">Ritorno</option>
            <option value="gara-1">Gara 1</option>
            <option value="gara-2">Gara 2</option>
            <option value="gara-3">Gara 3</option>
          </select>
        </div>
        <div class="col">
          <label>Tema</label>
          <div class="theme-toggle">
            <button type="button" id="theme-dark" class="secondary" aria-pressed="false" title="Tema scuro">üåô</button>
            <button type="button" id="theme-light" class="secondary" aria-pressed="false" title="Tema chiaro">‚òÄÔ∏è</button>
          </div>
        </div>
      </div>
      <div class="controls-row info-controls">
      </div>
    </div>
  <div class="section opponent-hidden" aria-hidden="true"></div>
    <div class="section">
      <h2>Giocatrici</h2>
      <p class="section-note">Gestisci l'elenco con i pulsanti. Cambiare la lista azzera le statistiche del match.</p>
      <div class="player-management our-team">
        <div class="add-player-row">
          <div class="col">
            <label for="new-player-name">Nuova giocatrice</label>
            <div class="add-player-inline">
              <input id="new-player-name" type="text" placeholder="Es: Martina Rossi" />
              <button id="btn-add-player">+ Aggiungi</button>
            </div>
          </div>
          <div class="col col-auto">
            <label class="spacer-label">&nbsp;</label>
            <button id="btn-clear-players" class="secondary">Svuota elenco</button>
          </div>
        </div>
        <div id="players-list" class="players-list"></div>
        <div class="team-manage">
          <label for="saved-teams">Squadre salvate</label>
          <div class="team-row">
            <select id="saved-teams">
              <option value="">Nuova squadra (vuota)</option>
            </select>
            <button id="btn-delete-team" class="danger">Elimina</button>
            <button id="btn-rename-team" class="secondary">Rinomina</button>
            <button id="btn-save-team">Salva squadra</button>
            <button id="btn-open-team-manager" class="secondary">Gestione squadra</button>
          </div>
          <div class="team-row">
            <button id="btn-export-team" class="secondary">Esporta su file</button>
            <button id="btn-import-team" class="secondary">Importa da file</button>
            <input id="team-file-input" type="file" accept="application/json,text/plain" hidden />
          </div>
        </div>
        <details class="import-panel">
          <summary>Incolla un elenco (opzionale)</summary>
          <label for="players-input">Formato: Nome;Numero;L (L opzionale per il libero). Sono accettati anche tab o spazi.</label>
          <textarea id="players-input" placeholder="Esempi:
Rossi;12;L
Verdi;7
Bianchi 18"></textarea>
          <div class="controls-row">
            <button id="btn-apply-players">Sostituisci elenco (resetta le statistiche)</button>
          </div>
        </details>
        <div class="libero-manage">
          <label for="libero-tags">Segna i liberi (solo per colore)</label>
          <div id="libero-tags" class="libero-tags"></div>
        </div>
      </div>
    </div>
    <div class="section">
      <details class="import-panel metrics-panel" open>
        <summary>Regole calcolo efficienza/positivit√†</summary>
        <p class="section-note">Positivit√† = positivi / totali ¬∑ Efficienza = (positivi - negativi) / totali ¬∑ Perfezione = # / totali.</p>
        <div class="controls-row metrics-actions">
          <button id="btn-reset-codes" class="secondary">Riattiva tutte le valutazioni</button>
          <button id="btn-reset-metrics" class="secondary">Ripristina criteri calcolo efficienza</button>
          <button id="btn-reset-points" class="secondary">Ripristina punti default</button>
        </div>
        <div id="metrics-config" class="metrics-config"></div>
      </details>
    </div>
    <div class="section">
      <h2>Azioni match</h2>
      <div class="controls-row">
        <button id="btn-reset-match" class="danger">Reset match</button>
        <button id="btn-share-match-link" class="secondary">Copia link partita</button>
        <button id="btn-export-match" class="secondary">Esporta match</button>
        <button id="btn-import-match" class="secondary">Importa match</button>
        <input id="match-file-input" type="file" accept="application/json,text/plain" hidden />
      </div>
      <div class="controls-row">
        <div class="col">
          <label for="saved-matches">Match salvati</label>
          <select id="saved-matches">
            <option value="">Nuovo match (vuoto)</option>
          </select>
        </div>
        <div class="col col-auto">
          <label class="spacer-label">&nbsp;</label>
          <div class="buttons-right">
            <button id="btn-delete-match" class="danger">Elimina</button>
          </div>
        </div>
      </div>
      <div class="controls-row">
        <button id="btn-export-db" class="secondary">Esporta database completo</button>
        <button id="btn-import-db" class="secondary">Importa database</button>
        <input id="db-file-input" type="file" accept="application/json,text/plain" hidden />
        <p class="section-note">Backup di tutte le impostazioni, squadre e match attuale in un unico file.</p>
      </div>
    </div>
  </div>

  <div class="tab-panel" data-tab="scout">
    <div class="scout-mobile-bar">
      <button id="btn-open-menu-mobile" class="secondary small" type="button" aria-label="Impostazioni">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 8.75a3.25 3.25 0 1 0 0 6.5a3.25 3.25 0 0 0 0-6.5ZM4.7 9.9l-1.65-1a1 1 0 0 1-.36-1.37l1.4-2.42a1 1 0 0 1 1.34-.4l1.8.78a7.7 7.7 0 0 1 1.64-.95l.28-1.94A1 1 0 0 1 9.15 1h2.7a1 1 0 0 1 .99.86l.28 1.94c.58.23 1.12.54 1.64.95l1.8-.78a1 1 0 0 1 1.34.4l1.4 2.42a1 1 0 0 1-.36 1.37l-1.65 1c.08.52.12 1.05.12 1.6s-.04 1.08-.12 1.6l1.65 1a1 1 0 0 1 .36 1.37l-1.4 2.42a1 1 0 0 1-1.34.4l-1.8-.78a7.7 7.7 0 0 1-1.64.95l-.28 1.94a1 1 0 0 1-.99.86h-2.7a1 1 0 0 1-.99-.86l-.28-1.94a7.7 7.7 0 0 1-1.64-.95l-1.8.78a1 1 0 0 1-1.34-.4l-1.4-2.42a1 1 0 0 1 .36-1.37l1.65-1a9.9 9.9 0 0 1-.12-1.6c0-.55.04-1.08.12-1.6Z"/>
        </svg>
      </button>
      <button id="btn-open-log-mobile" class="secondary small" type="button">Log</button>
    </div>
    <div id="scout-drawer-backdrop" class="drawer-backdrop" aria-hidden="true"></div>
    <div class="scout-grid">
      <div class="section scout-col-left" data-scout-panel="match">
        <button class="drawer-close secondary small" type="button" data-close-drawer="menu">Chiudi</button>
        <div class="set-controls grid-row">
          <div class="score-card score-card-top">
            <div class="score-top-row">
              <div class="score-set-select">
                <label for="current-set">Set corrente</label>
                <div class="set-display" id="current-set-display" aria-live="polite">Set 1</div>
                <select id="current-set" class="hidden-select" tabindex="-1" aria-hidden="true">
                  <option value="1">Set 1</option>
                  <option value="2">Set 2</option>
                  <option value="3">Set 3</option>
                  <option value="4">Set 4</option>
                  <option value="5">Set 5</option>
                </select>
              </div>
            </div>
          <div class="score-layout">
            <div class="score-side score-side-for">
              <button id="btn-score-for-plus" class="small">+ Fatti</button>
              <button id="btn-score-for-minus" class="small secondary">- Fatti</button>
            </div>
              <div class="score-center">
                <label>Punteggio</label>
                <div id="live-score" class="score-value emph">0 - 0</div>
              </div>
              <div class="score-side score-side-against">
                <button id="btn-score-against-plus" class="small">+ Subiti</button>
                <button id="btn-score-against-minus" class="small secondary">- Subiti</button>
              </div>
            </div>
          </div>
          <div class="set-bottom-actions">
            <button id="btn-next-set" class="small secondary">Set successivo</button>
            <button id="btn-end-match" class="small danger">Pausa/Termina</button>
          </div>
          <div class="rotation-toggles">
            <label class="auto-rotate-toggle">
              <input type="checkbox" id="auto-rotate-toggle" />
              Rotazione automatica su cambio palla
            </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="auto-role-toggle" />
                Auto posizionamento per ruolo
              </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="predictive-skill-toggle" />
                Flusso skill automatico
                </label><br>
              <label class="auto-rotate-toggle">
                <input type="checkbox" id="force-mobile-toggle" />
                Modalit√† mobile (test)
              </label>
            </div>
        </div>
        <div class="team-settings-panel court-actions-bar">
          <h3 class="panel-title">Impostazioni squadra</h3>
          <div class="rotation-toggles">
            <label class="auto-rotate-toggle">
              <input type="checkbox" id="auto-role-p1american-toggle" />
              P1 americana
            </label>
            <label class="auto-rotate-toggle">
              <input type="checkbox" id="attack-trajectory-toggle" />
              Traiettoria attacco
            </label>
          </div>
        </div>
      </div>
      <div class="section scout-col-center" data-scout-panel="team">
        <div class="set-type-wrapper">
          <div class="set-type-shortcuts set-type-inline" id="set-type-shortcuts" style="display: none">
            <div class="set-type-shortcuts__head">
              <span class="set-type-shortcuts__label">Tipo alzata</span>
            </div>
            <div class="set-type-shortcuts__buttons">
              <button class="set-type-btn" data-settype="mezza" type="button">Mezza(M)</button>
              <button class="set-type-btn" data-settype="super" type="button">Super(S)</button>
              <button class="set-type-btn" data-settype="quick" type="button">Quick(Q)</button>
              <button class="set-type-btn" data-settype="veloce" type="button">Veloce(V)</button>
              <button class="set-type-btn" data-settype="fast" type="button">Fast(F)</button>
              <button class="set-type-btn" data-settype="alta" type="button">Alta(A)</button>
              <button class="set-type-btn secondary" data-clear-settype type="button">Nessuna(N)</button>
            </div>
          </div>
        </div>
        <div class="players-area">
          <div id="players-container"></div>
          <div class="court-actions-bar court-actions-inline">
            <div class="rotation-block court-rotation-block">
              <div class="rotation-controls">
                <button id="btn-rotate-cw" class="small rotate-cw">‚Ü∫</button>
                <div class="rotation-display">
                  <select id="rotation-select" class="rotation-select">
                    <option value="1">P1</option>
                    <option value="2">P2</option>
                    <option value="3">P3</option>
                    <option value="4">P4</option>
                    <option value="5">P5</option>
                    <option value="6">P6</option>
                  </select>
                </div>
                <button id="btn-rotate-ccw" class="small rotate-ccw">‚Üª</button>
              </div>
            </div>
            <div class="score-actions court-game-actions">
              <button id="btn-score-team-point" class="small">Punto</button>
              <button id="btn-score-team-error" class="small danger">Errore</button>
              <button id="btn-freeball" class="secondary small">Freeball</button>
              <button id="btn-open-lineup" class="secondary small">Formazione</button>
            </div>
            <div class="team-controls-panel">
              <div class="libero-inline">
                <label>Libero</label>
                <div id="libero-tags-inline" class="libero-tags"></div>
                <label class="auto-libero-inline">
                  <span>Auto L</span>
                  <select id="auto-libero-select">
                    <option value="">Nessuno</option>
                    <option value="P">P</option>
                    <option value="S">S</option>
                    <option value="C">C</option>
                    <option value="O">O</option>
                  </select>
                </label>
                <button type="button" id="btn-swap-libero" class="small secondary">Cambia L</button>
              </div>
              <div class="skill-flow-panel">
                <label>Forza prossima skill</label>
                <div class="skill-flow-grid skill-flow-inline" id="skill-flow-buttons">
                  <button type="button" class="skill-flow-btn badge badge-serve" data-force-skill="serve">Ba</button>
                  <button type="button" class="skill-flow-btn badge badge-pass" data-force-skill="pass">Ri</button>
                  <button type="button" class="skill-flow-btn badge badge-attack" data-force-skill="attack">At</button>
                  <button type="button" class="skill-flow-btn badge badge-block" data-force-skill="block">Mu</button>
                  <button type="button" class="skill-flow-btn badge badge-defense" data-force-skill="defense">Di</button>
                  <button type="button" class="skill-flow-btn badge badge-second" data-force-skill="second">Al</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="section log-section scout-col-right" data-log-section data-scout-panel="log">
        <button class="drawer-close secondary small" type="button" data-close-drawer="log">Chiudi</button>
        <div id="events-log-summary" class="events-log-summary" aria-live="polite"></div>
        <div id="events-log"></div>
        <div class="card-inline log-undo">
          <button id="btn-undo" class="small danger undo-inline">‚Ü© Annulla ultimo</button>
          <div class="undo-last-summary" aria-live="polite">
            <span>Ultimo codice:</span>
            <strong id="undo-last-summary">‚Äî</strong>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-panel" data-tab="aggregated" id="aggregated-panel">
    <div class="section">
      <div class="agg-subnav">
        <button class="agg-subtab-btn active" data-agg-tab-target="summary">Tabellino</button>
        <button class="agg-subtab-btn" data-agg-tab-target="second">Alzate</button>
        <button class="agg-subtab-btn" data-agg-tab-target="trajectory">Traiettorie</button>
      </div>
      <div class="agg-subpanel active" data-agg-tab="summary">
        <div class="score-summary">
          <div class="score-card">
            <label>Punteggio totale</label>
            <div id="agg-score" class="score-value">0 - 0</div>
            <div id="agg-set-cards" class="score-sets cards"></div>
          </div>
        </div>
        <div class="table-wrapper">
          <table class="agg-table">
            <thead>
              <tr>
                <th rowspan="2">Atleta</th>
                <th colspan="4">Punti</th>
                <th colspan="5" class="skill-col skill-serve">Battuta</th>
                <th colspan="5" class="skill-col skill-pass">Ricezione</th>
                <th colspan="6" class="skill-col skill-attack">Attacco</th>
                <th colspan="2" class="skill-col skill-block">Muro</th>
                <th colspan="3" class="skill-col skill-defense">Difesa</th>
              </tr>
              <tr>
                <th>Fatti</th>
                <th>Subiti</th>
                <th>Œî</th>
                <th>Err pers</th>

                <th class="skill-col skill-serve">Tot</th>
                <th class="skill-col skill-serve">Err</th>
                <th class="skill-col skill-serve">Punti</th>
                <th class="skill-col skill-serve">Eff</th>
                <th class="skill-col skill-serve">Pos</th>

                <th class="skill-col skill-pass">Tot</th>
                <th class="skill-col skill-pass">Err</th>
                <th class="skill-col skill-pass">Pos</th>
                <th class="skill-col skill-pass">Prf</th>
                <th class="skill-col skill-pass">Eff</th>

                <th class="skill-col skill-attack">Tot</th>
                <th class="skill-col skill-attack">Err</th>
                <th class="skill-col skill-attack">Mur</th>
                <th class="skill-col skill-attack">Punti</th>
                <th class="skill-col skill-attack">% Punti</th>
                <th class="skill-col skill-attack">Eff</th>

                <th class="skill-col skill-block">Tot</th>
                <th class="skill-col skill-block">Punti</th>

                <th class="skill-col skill-defense">Tot</th>
                <th class="skill-col skill-defense">Err</th>
                <th class="skill-col skill-defense">Eff</th>
              </tr>
            </thead>
            <tbody id="agg-table-body">
              <tr>
                <td colspan="26">Registra alcuni eventi per vedere le statistiche aggregate.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="table-wrapper rotation-wrapper">
          <table class="rotation-table">
            <thead>
              <tr>
                <th>Rot (P1-P6)</th>
                <th>Punti fatti</th>
                <th>Punti subiti</th>
                <th>Œî</th>
              </tr>
            </thead>
            <tbody id="rotation-table-body">
              <tr>
                <td colspan="4">Registra eventi per vedere le rotazioni.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="trajectory">
        <div class="trajectory-layout">
          <div class="analysis-filters trajectory-filters">
            <div class="analysis-filter">
              <div class="analysis-filter__label">Giocatrici</div>
              <div id="traj-filter-players" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Set</div>
              <div id="traj-filter-sets" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Tipo alzata</div>
              <div id="traj-filter-set-types" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Base</div>
              <div id="traj-filter-bases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Fase (SO/BP)</div>
              <div id="traj-filter-phases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione rice</div>
              <div id="traj-filter-receive-evals" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona ricezione</div>
              <div id="traj-filter-receive-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione attacco</div>
              <div id="traj-filter-codes" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona partenza</div>
              <div id="traj-filter-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Skill precedente</div>
              <select id="traj-filter-prev">
                <option value="any">Tutte</option>
                <option value="freeball-positive">Freeball o ricezione positiva</option>
                <option value="defense-negative">Difesa + ricezione negativa</option>
                <option value="freeball-only">Solo freeball</option>
                <option value="dig-only">Solo difesa</option>
              </select>
            </div>
            <div class="analysis-filter filter-actions">
              <button id="traj-filter-reset" class="secondary small" type="button">Reset filtri</button>
            </div>
          </div>
          <div id="trajectory-grid" class="trajectory-grid">
            <div class="trajectory-card traj-area-z4" data-zone="4">
              <div class="trajectory-card__title">Zona 4</div>
              <canvas data-traj-canvas="4"></canvas>
              <div class="trajectory-card__empty">Nessuna traiettoria</div>
            </div>
          <div class="trajectory-card traj-area-z3" data-zone="3">
            <div class="trajectory-card__title">Zona 3</div>
            <canvas data-traj-canvas="3"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z2" data-zone="2">
            <div class="trajectory-card__title">Zona 2</div>
            <canvas data-traj-canvas="2"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z5" data-zone="5">
            <div class="trajectory-card__title">Zona 5</div>
            <canvas data-traj-canvas="5"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
          <div class="trajectory-card traj-area-z6" data-zone="6">
            <div class="trajectory-card__title">Zona 6</div>
            <canvas data-traj-canvas="6"></canvas>
            <div class="trajectory-card__empty">Nessuna traiettoria</div>
          </div>
            <div class="trajectory-card traj-area-z1" data-zone="1">
              <div class="trajectory-card__title">Zona 1</div>
              <canvas data-traj-canvas="1"></canvas>
              <div class="trajectory-card__empty">Nessuna traiettoria</div>
            </div>
          </div>
        </div>
      </div>
      <div class="agg-subpanel" data-agg-tab="second">
        <div class="second-layout">
          <div class="analysis-filters" id="second-filters">
            <div class="analysis-filter">
              <div class="analysis-filter__label">Alzatrice</div>
              <div id="second-filter-setters" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Tipo alzata</div>
              <div id="second-filter-set-types" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Base</div>
              <div id="second-filter-bases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Fase (SO/BP)</div>
              <div id="second-filter-phases" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Valutazione rice</div>
              <div id="second-filter-receive-evals" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Zona ricezione</div>
              <div id="second-filter-receive-zones" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Set</div>
              <div id="second-filter-sets" class="analysis-filter__options"></div>
            </div>
            <div class="analysis-filter">
              <div class="analysis-filter__label">Skill precedente</div>
              <select id="second-filter-prev">
                <option value="any">Tutte</option>
                <option value="freeball-positive">Freeball o ricezione positiva</option>
                <option value="defense-negative">Difesa + ricezione negativa</option>
                <option value="freeball-only">Solo freeball</option>
                <option value="dig-only">Solo difesa</option>
              </select>
            </div>
            <div class="analysis-filter filter-actions">
              <button id="second-filter-reset" class="secondary small" type="button">Reset filtri</button>
            </div>
          </div>
          <div class="distribution-section">
            <h3>Distribuzione alzate per rotazione</h3>
            <div id="second-distribution" class="distribution-grid"></div>
          </div>
        </div>
        <div class="table-wrapper">
          <table class="agg-table">
            <thead>
              <tr>
                <th>Alzatrice</th>
                <th class="skill-col skill-second">Tot</th>
                <th class="skill-col skill-second">#</th>
                <th class="skill-col skill-second">+</th>
                <th class="skill-col skill-second">!</th>
                <th class="skill-col skill-second">-</th>
                <th class="skill-col skill-second">=</th>
                <th class="skill-col skill-second">/</th>
                <th class="skill-col skill-second">Pos</th>
                <th class="skill-col skill-second">Prf</th>
                <th class="skill-col skill-second">Eff</th>
              </tr>
            </thead>
            <tbody id="agg-second-body">
              <tr>
                <td colspan="11">Registra alzate per vedere il dettaglio.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="controls-row agg-actions">
        <button id="btn-export-csv">Esporta CSV</button>
        <button id="btn-copy-csv" class="secondary">Copia CSV</button>
        <button id="btn-export-pdf" class="secondary">Esporta PDF</button>
      </div>
    </div>
  </div>
  <div class="tab-panel" data-tab="video" id="video-panel">
    <div class="section video-analysis">
        <div class="video-analysis__head">
          <div>
            <h2>Analisi video</h2>
            <p class="section-note">Carica un video e sincronizza le skill registrate per saltare al momento corretto.</p>
          </div>
          <div class="video-analysis__actions">
            <label class="file-btn" for="video-file-input">Carica video</label>
            <input id="video-file-input" type="file" accept="video/*" hidden />
            <button id="btn-sync-first-skill" class="secondary">Sincronizza prima skill</button>
            <button id="btn-copy-ffmpeg" class="secondary">Copia ffmpeg (selezione)</button>
            <div class="youtube-input">
              <input id="youtube-url-input" type="url" placeholder="https://youtu.be/..." />
              <button id="btn-load-youtube" class="secondary">Usa YouTube</button>
            </div>
          </div>
      </div>
      <div class="video-analysis__grid">
        <div class="video-skills">
          <div class="table-wrapper video-table-wrapper">
            <div id="video-skills-container"></div>
          </div>
        </div>
        <div class="video-player-wrap">
          <video id="analysis-video" controls preload="metadata"></video>
          <iframe
            id="youtube-frame"
            class="youtube-frame"
            title="YouTube player"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
          <p class="section-note">Seleziona una skill per spostarti al timestamp calcolato. Puoi usare un file o un link YouTube.</p>
        </div>
      </div>
    </div>
  </div>
  <noscript>Questa applicazione richiede JavaScript abilitato.</noscript>
  <div id="team-manager-modal" class="team-modal hidden" role="dialog" aria-modal="true">
    <div class="team-modal__backdrop"></div>
    <div class="team-modal__dialog">
      <div class="team-modal__head">
        <h3>Gestione squadra</h3>
        <button id="team-manager-close" aria-label="Chiudi" class="icon-button">‚úï</button>
      </div>
        <div class="team-modal__content">
        <div class="team-meta-grid">
          <label>Nome squadra
            <input type="text" id="team-meta-name" placeholder="Nome squadra" />
          </label>
          <label>Head coach
            <input type="text" id="team-meta-head" placeholder="Allenatore" />
          </label>
          <label>Vice
            <input type="text" id="team-meta-assistant" placeholder="Assistente" />
          </label>
          <label>Team manager
            <input type="text" id="team-meta-manager" placeholder="Manager" />
          </label>
        </div>
        <p class="section-note">Imposta staff, capitana (C), liberi (L) e chi √® fuori rosa. La prima riga definisce la lineup di default. I ruoli in campo sono sempre inferiti automaticamente dalla posizione del palleggiatore nella rotazione reale.</p>
        <div class="team-manager-actions">
          <button id="team-manager-add" class="secondary">Aggiungi giocatrice</button>
          <button id="team-manager-duplicate" class="secondary">Duplica elenco</button>
          <button id="team-manager-lineup" class="secondary">Imposta formazione</button>
          <button id="team-manager-template" class="secondary hidden">Genera squadra di default</button>
        </div>
        <div class="table-wrapper team-manager-tablewrap">
          <table class="team-manager-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Cognome</th>
                <th>Nome</th>
                <th>Capitano</th>
                <th>Libero</th>
                <th>Fuori rosa</th>
                <th>Azioni</th>
              </tr>
            </thead>
            <tbody id="team-manager-body"></tbody>
          </table>
        </div>
        <div class="team-manager-footer">
          <button id="team-manager-cancel" class="secondary">Annulla</button>
          <button id="team-manager-save" class="primary">Salva</button>
        </div>
      </div>
    </div>
  </div>
  <div id="skill-modal" class="skill-modal hidden" role="dialog" aria-modal="true">
    <div class="skill-modal__backdrop" data-close-skill onclick="window._closeSkillModal && window._closeSkillModal()"></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="skill-modal-title" class="skill-modal__title"></div>
        <button id="skill-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button" data-close-skill="true" onclick="window._closeSkillModal && window._closeSkillModal()">‚úï</button>
      </div>
      <div id="skill-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="error-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="error-modal-title">
    <div class="skill-modal__backdrop" data-close-error></div>
    <div class="skill-modal__content">
      <div class="skill-modal__head">
        <div id="error-modal-title" class="skill-modal__title">Assegna errore/fallo</div>
        <button id="error-modal-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div id="error-modal-body" class="skill-modal__body"></div>
    </div>
  </div>
  <div id="attack-trajectory-modal" class="skill-modal hidden" role="dialog" aria-modal="true" aria-labelledby="attack-trajectory-title">
    <div class="skill-modal__backdrop" data-close-trajectory></div>
    <div class="skill-modal__content attack-trajectory-content">
      <div class="skill-modal__head">
        <div id="attack-trajectory-title" class="skill-modal__title">Seleziona traiettoria attacco</div>
        <button id="attack-trajectory-close" class="pill-remove skill-modal__close-abs" aria-label="Chiudi" type="button">‚úï</button>
      </div>
      <div class="attack-trajectory-body">
        <div class="attack-trajectory-instructions">Clicca (o trascina) per disegnare la traiettoria dal punto di partenza a quello di arrivo.</div>
        <div class="attack-trajectory-stage">
          <img id="attack-trajectory-image" alt="Campo per traiettoria" />
          <canvas id="attack-trajectory-canvas"></canvas>
        </div>
      </div>
      <div class="attack-trajectory-actions">
        <button id="attack-trajectory-close-btn" class="secondary small" type="button">Chiudi</button>
      </div>
    </div>
  </div>
  <div id="settings-modal" class="settings-modal hidden" role="dialog" aria-modal="true" aria-labelledby="settings-modal-title">
    <div class="settings-modal__backdrop" data-close-settings></div>
    <div class="settings-modal__content">
      <div class="settings-modal__head">
        <h3 id="settings-modal-title">Impostazioni automatismi</h3>
        <button id="settings-close" class="pill-remove" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="settings-modal__body">
        <label class="auto-rotate-toggle">
          <input type="checkbox" id="auto-rotate-toggle-settings" />
          Rotazione automatica su cambio palla
        </label>
        <label class="auto-rotate-toggle">
          <input type="checkbox" id="auto-role-toggle-settings" />
          Auto posizionamento per ruolo
        </label>
        <label class="auto-rotate-toggle auto-libero-row">
          <span>Libero automatico</span>
          <div class="auto-libero-controls">
            <select id="auto-libero-select-settings">
              <option value="">Nessuno</option>
              <option value="P">P</option>
              <option value="S">S</option>
              <option value="C">C</option>
              <option value="O">O</option>
            </select>
            <button type="button" id="btn-swap-libero-settings" class="small secondary">Cambia libero</button>
          </div>
        </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="auto-role-p1american-toggle-settings" />
                  P1 americana (OH in 4, OP in 2 su cambio palla)
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="attack-trajectory-toggle-settings" />
                  Disegna traiettoria attacco
                </label>
                <label class="auto-rotate-toggle">
                  <input type="checkbox" id="predictive-skill-toggle-settings" />
                  Flusso skill automatico
                </label>
      </div>
    </div>
  </div>
  <script src="js/globals.js"></script>
  <script src="js/shared/team-ui.js"></script>
  <script src="js/shared/lineup-core.js"></script>
  <script src="js/shared/auto-role.js"></script>
  <script src="js/shared/roster-manager.js"></script>
  <script src="js/match-settings.js"></script>
  <script src="js/opponent-settings.js"></script>
  <script src="js/roster-lineup.js"></script>
  <script src="js/scout-ui.js"></script>
</body>
</html>
